<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>Lxc Privilege Conversion | dev Boer Docs</title>
<meta name="keywords" content="">
<meta name="description" content="Goal Align privileged LXC Jellyfin container&rsquo;s permissions with unprivileged Servarr companion services.
Catalyst Since, I have introduced Servarr, I was having wonky issues with Jellyfin losing controls over its media. And, I learned privileged containers means same IDs as host, I had to remedy this pronto!
So far, I have learned, PVE 9 doesn’t have un|shift pct command nor uidmappingshift (something like this) to convert LXC container from privileged to unprivileged.">
<meta name="author" content="">
<link rel="canonical" href="http://docs.devboer.com/docs/lxc-privilege-conversion/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.b609c58d5c11bb90b1a54e04005d74ad1ddf22165eb79f5533967e57df9c3b50.css" integrity="sha256-tgnFjVwRu5CxpU4EAF10rR3fIhZet59VM5Z&#43;V9&#43;cO1A=" rel="preload stylesheet" as="style">
<link rel="icon" href="http://docs.devboer.com/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="http://docs.devboer.com/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="http://docs.devboer.com/favicon-32x32.png">
<link rel="apple-touch-icon" href="http://docs.devboer.com/apple-touch-icon.png">
<link rel="mask-icon" href="http://docs.devboer.com/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="en" href="http://docs.devboer.com/docs/lxc-privilege-conversion/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --code-block-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript>
  

<meta property="og:title" content="Lxc Privilege Conversion" />
<meta property="og:description" content="Goal Align privileged LXC Jellyfin container&rsquo;s permissions with unprivileged Servarr companion services.
Catalyst Since, I have introduced Servarr, I was having wonky issues with Jellyfin losing controls over its media. And, I learned privileged containers means same IDs as host, I had to remedy this pronto!
So far, I have learned, PVE 9 doesn’t have un|shift pct command nor uidmappingshift (something like this) to convert LXC container from privileged to unprivileged." />
<meta property="og:type" content="article" />
<meta property="og:url" content="http://docs.devboer.com/docs/lxc-privilege-conversion/" /><meta property="article:section" content="docs" />
<meta property="article:published_time" content="2025-09-27T20:19:13-05:00" />
<meta property="article:modified_time" content="2025-09-27T20:19:13-05:00" />

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Lxc Privilege Conversion"/>
<meta name="twitter:description" content="Goal Align privileged LXC Jellyfin container&rsquo;s permissions with unprivileged Servarr companion services.
Catalyst Since, I have introduced Servarr, I was having wonky issues with Jellyfin losing controls over its media. And, I learned privileged containers means same IDs as host, I had to remedy this pronto!
So far, I have learned, PVE 9 doesn’t have un|shift pct command nor uidmappingshift (something like this) to convert LXC container from privileged to unprivileged."/>


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Docs",
      "item": "http://docs.devboer.com/docs/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "Lxc Privilege Conversion",
      "item": "http://docs.devboer.com/docs/lxc-privilege-conversion/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "Lxc Privilege Conversion",
  "name": "Lxc Privilege Conversion",
  "description": "Goal Align privileged LXC Jellyfin container\u0026rsquo;s permissions with unprivileged Servarr companion services.\nCatalyst Since, I have introduced Servarr, I was having wonky issues with Jellyfin losing controls over its media. And, I learned privileged containers means same IDs as host, I had to remedy this pronto!\nSo far, I have learned, PVE 9 doesn’t have un|shift pct command nor uidmappingshift (something like this) to convert LXC container from privileged to unprivileged.",
  "keywords": [
    
  ],
  "articleBody": "Goal Align privileged LXC Jellyfin container’s permissions with unprivileged Servarr companion services.\nCatalyst Since, I have introduced Servarr, I was having wonky issues with Jellyfin losing controls over its media. And, I learned privileged containers means same IDs as host, I had to remedy this pronto!\nSo far, I have learned, PVE 9 doesn’t have un|shift pct command nor uidmappingshift (something like this) to convert LXC container from privileged to unprivileged.\nI imagined this going smoother when using ChatGPT and web searches. I had a few challenges with my Jellyfin LXC being privileged and my servarr instances with unprivileged access.\nInside privileged container it had two files to remove ‘random’ and ‘urandom’ that were device types inside /var. (Correction?) Comment out specific lines in my container config file: lxc.idmap and cgroup access to GPU Backup container with the container ‘cleaned’ of the above Restore with unprivileged switch to 1 As I recall the challenges above were resolved when trying to restore the container. Each time I failed I restored it to privileged and fixed the requirements until I could restore it unprivileged.\nWithout any challenges, I was ready to complete the project… pct stop vzdump —dumpdir /path/to/backup\npct destroy or last for backup but need a different container id for restore\nA) pvesm status to see my storage options\nB) pct restore /path/to/backup —storage —unprivileged 1\nFrom here I had problems with jellyfin’s directories owned by ‘nobody’ and group ‘adm’ UID: 65534; GID: 4. And, this was the issue before I stumbled upon container conversion. Just now it is only on Jellyfin’s directories, funny enough.\nSo lots of trying things with help of searching the web and using ChatGPT and DeepSeek. I noticed nothing works, dead end reached inside container operations with “not permitted” errors.\nAnd so, I learned something about Proxmox, where it keeps its containers when mounted.\npct stop [!info] https://etldispatch.com/blog/reviving-a-broken-lxc-container/\n[!info] https://cloudspinx.com/convert-unprivileged-container-in-proxmox-to-privileged/\npct mount chown -R 100000:100000 /var/lib/lxc//rootfs/path/to/change\nThe six-digit UID:GID is the ID of root inside container that will convert to UID:GID of ‘0’.\nProblem solved!\nFrom here, I started container back up and “chowned” the directory to ‘jellyfin’\nJELLYFIN_DATA_DIR=\"/var/lib/jellyfin\" JELLYFIN_CONFIG_DIR=\"/etc/jellyfin\" JELLYFIN_LOG_DIR=\"/var/log/jellyfin\" JELLYFIN_CACHE_DIR=\"/var/cache/jellyfin\" Nvidia device files are also owned by ‘nobody’. After much delibration and trial + error, I find this to not matter.\nI have an unprivileged container with proper uid:gid mapping from host to container and a working GPU binding. The GPU issue is something I’ll report on later when I learn more about what kernel issues I had with nvidia installer. This time around Nvidia installer ran without issue on the host like before.\nConnection complete, and ON to the next adventure! Next Up … I’d like to learn how to run my LXC container’s service rootless similar to Docker\n",
  "wordCount" : "464",
  "inLanguage": "en",
  "datePublished": "2025-09-27T20:19:13-05:00",
  "dateModified": "2025-09-27T20:19:13-05:00",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "http://docs.devboer.com/docs/lxc-privilege-conversion/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "dev Boer Docs",
    "logo": {
      "@type": "ImageObject",
      "url": "http://docs.devboer.com/favicon.ico"
    }
  }
}
</script>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="http://docs.devboer.com/" accesskey="h" title="dev Boer Docs (Alt + H)">dev Boer Docs</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    
    <h1 class="post-title entry-hint-parent">
      Lxc Privilege Conversion
    </h1>
    <div class="post-meta"><span title='2025-09-27 20:19:13 -0500 -0500'>September 27, 2025</span>

</div>
  </header> 
  <div class="post-content"><p><strong>Goal</strong> Align privileged LXC Jellyfin container&rsquo;s permissions with unprivileged Servarr companion services.</p>
<p><strong>Catalyst</strong> Since, I have introduced Servarr, I was having wonky issues with Jellyfin losing controls over its media. And, I learned privileged containers means same IDs as host, I had to remedy this pronto!</p>
<p>So far, I have learned, PVE 9 doesn’t have un|shift pct command nor uidmappingshift (something like this) to convert LXC container from privileged to unprivileged.</p>
<p>I imagined this going smoother when using ChatGPT and web searches. I had a few challenges with my Jellyfin LXC being privileged and my servarr instances with unprivileged access.</p>
<ul>
<li>Inside privileged container it had two files to remove &lsquo;random&rsquo; and &lsquo;urandom&rsquo; that were device types inside /var. (Correction?)</li>
<li>Comment out specific lines in my container config file: lxc.idmap and cgroup access to GPU</li>
<li>Backup container with the container &lsquo;cleaned&rsquo; of the above</li>
<li>Restore with unprivileged switch to 1</li>
</ul>
<p>As I recall the challenges above were resolved when trying to restore the container. Each time I failed I restored it to privileged and fixed the requirements until I could restore it unprivileged.</p>
<h3 id="without-any-challenges-i-was-ready-to-complete-the-project">Without any challenges, I was ready to complete the project&hellip;<a hidden class="anchor" aria-hidden="true" href="#without-any-challenges-i-was-ready-to-complete-the-project">#</a></h3>
<ol>
<li>
<p><code>pct stop &lt;container-id&gt;</code></p>
</li>
<li>
<p><code>vzdump &lt;container-id&gt; —dumpdir /path/to/backup</code></p>
</li>
<li>
<p><code>pct destroy &lt;container-id&gt;</code> or last for backup but need a different container id for restore</p>
</li>
<li>
<p>A) <code>pvesm status</code> to see my storage options</p>
</li>
<li>
<p>B) <code>pct restore &lt;new-container-id&gt; /path/to/backup —storage &lt;storage_pool&gt; —unprivileged 1</code></p>
</li>
</ol>
<p>From here I had problems with jellyfin’s directories owned by ‘nobody’ and group ‘adm’ UID: 65534; GID: 4. And, this was the issue before I stumbled upon container conversion. Just now it is only on Jellyfin&rsquo;s directories, funny enough.</p>
<p>So lots of trying things with help of searching the web and using ChatGPT and DeepSeek. I noticed nothing works, dead end reached inside container operations with “not permitted” errors.</p>
<p>And so, I learned something about Proxmox, where it keeps its containers when mounted.</p>
<p><code>pct stop &lt;container-id&gt;</code>
[!info] <a href="https://etldispatch.com/blog/reviving-a-broken-lxc-container/">https://etldispatch.com/blog/reviving-a-broken-lxc-container/</a></p>
<p>[!info] <a href="https://cloudspinx.com/convert-unprivileged-container-in-proxmox-to-privileged/">https://cloudspinx.com/convert-unprivileged-container-in-proxmox-to-privileged/</a></p>
<p><code>pct mount &lt;container-id&gt;</code></p>
<p>chown -R 100000:100000 /var/lib/lxc/<!-- raw HTML omitted -->/rootfs/path/to/change</p>
<p>The six-digit UID:GID is the ID of root inside container that will convert to UID:GID of ‘0’.</p>
<p>Problem solved!</p>
<p>From here, I started container back up and “chowned” the directory to ‘jellyfin’</p>
<ul>
<li>JELLYFIN_DATA_DIR=&quot;/var/lib/jellyfin&quot;</li>
<li>JELLYFIN_CONFIG_DIR=&quot;/etc/jellyfin&quot;</li>
<li>JELLYFIN_LOG_DIR=&quot;/var/log/jellyfin&quot;</li>
<li>JELLYFIN_CACHE_DIR=&quot;/var/cache/jellyfin&quot;</li>
</ul>
<p>Nvidia device files are also owned by ‘nobody’. After much delibration and trial + error, I find this to not matter.</p>
<p>I have an unprivileged container with proper uid:gid mapping from host to container and a working GPU binding. The GPU issue is something I&rsquo;ll report on later when I learn more about what kernel issues I had with nvidia installer. This time around Nvidia installer ran without issue on the host like before.</p>
<h3 id="connection-complete-and-on-to-the-next-adventure">Connection complete, and ON to the next adventure!<a hidden class="anchor" aria-hidden="true" href="#connection-complete-and-on-to-the-next-adventure">#</a></h3>
<h2 id="next-up-">Next Up &hellip;<a hidden class="anchor" aria-hidden="true" href="#next-up-">#</a></h2>
<p><em>I&rsquo;d like to learn how to run my LXC container&rsquo;s service rootless similar to Docker</em></p>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
    </ul>
  </footer>
</article>
    </main>
    
<footer class="footer">
        <span>&copy; 2025 <a href="http://docs.devboer.com/">dev Boer Docs</a></span> · 

    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
</body>

</html>
